# ✅ 11月取材向け：対戦用AI起動マニュアル
11月の取材にて、チームで開発されたAIが対戦できるよう、コナミ側で対戦用AIを準備しました。  
以下は、最低限実施していただきたい手順です。

各ステップは `.bat` ファイルで実行可能です：

- **AI実行環境構築**  
　`C:\UDI\samples\etc\opponent_ai_cython\Step1_make_env.bat`

- **対戦用AIの起動（前半）**  
　`C:\UDI\samples\etc\opponent_ai_cython\Step2_run_ModelCy.bat`

- **対戦用AIの起動（後半）**  
　`C:\UDI\samples\etc\opponent_ai_cython\Step3_run_ClientCy.bat {チームで使用しているtcp_host}`  
　※ この .bat ファイルは、引数として`tcp_host`を指定する必要があります。
ターミナルやコマンドプロンプトから、チームで使用している`tcp_host`の値を {} に入れて実行してください。

```bash
# tcp_host 10.84.101.35の場合
C:\UDI\samples\etc\opponent_ai_cython\Step3_run_ClientCy.bat 10.84.101.35
```

---

## 🛠️ AI実行環境の構築手順

`.bat` ファイルでの実行でも問題ありませんが、手動で行う場合は以下の手順です。

### 1. Python仮想環境の作成
仮想環境用のディレクトリをmkdirする場所は好きなところで大丈夫です

```bash
mkdir Workspace_OpponentAI
cd Workspace_OpponentAI
py -3.12 -m venv .venv
.venv\Scripts\activate
```

### 2. 必要ライブラリのインストール

```bash
pip install \UDI\libs\ygo
pip install torch==2.8.0 torchvision==0.23.0 --index-url https://download.pytorch.org/whl/cu129
pip install grpcio-tools==1.74.0
pip install pycryptodome==3.23.0
```

---

## 🚀 AIの起動方法

「ModelCy」と「ClientCy」の2つのPythonファイルを**同時に起動**する必要があります。  
コマンドプロンプトを2つ立ち上げ、それぞれで仮想環境を起動して実行してください。

また、tcp_portだけではなく、この2つを接続するportもあるのでご注意ください。クライアントのtcp_port番号は自由で構いませんが、  tcp_port番号が「50002」の時の例として記述します。

### 1. ModelCy の起動

```bash
cd Workspace_OpponentAI
.venv\Scripts\activate
cd C:\UDI\samples\etc\opponent_ai_cython\ModelCy\
python run.py --Port 50806
```

### 2. ClientCy の起動

※ `--tcphost` の値はチームで使用しているものに変更してください。

```bash
cd Workspace_OpponentAI
.venv\Scripts\activate
cd C:\UDI\samples\etc\opponent_ai_cython\ClientCy\
python run.py --tcphost 10.84.101.35 --tcpport 50002 --LoopNum 100000 --GrpcAddressPort localhost:50806 --RandomActionRate 0.0
```

---

## 🧪 取材時の対戦手順（ルームマッチ）

1. **開発AIクライアントを起動**（tcp_port: `50001`）  
2. **対戦用AIクライアントを起動**（tcp_port: `50002`）  
3. **1つ目のMDクライアント（インスタンス1）を起動**：`C:\UDI\MD1`（tcp_port: `50001`）  
4. **2つ目のMDクライアント（インスタンス1）を起動**：`C:\UDI\MD2`（tcp_port: `50002`）  
5. **ルームマッチで対戦を開始**

---

## 📄 参考ドキュメント

- **対戦用AIの詳細**  
　`C:/UDI/samples/etc/opponent_ai_cython/doc/readme.md`

- **ルームマッチの手順**  
　`C:/UDI/docs/03.UDI対応版MDクライアントについて.doc`  
　→「ルーム戦を使ったデュエル確認について」セクション
